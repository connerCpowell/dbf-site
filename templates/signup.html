{% extends "base.html" %}

{% block content %}

<h1> MIDS MAILING LIST </h1>

<p> Gimme that dirty little email address...
	<br>
	buy the ticket, ride the ride
</p>


<form id="emailForm">
	<input type="email" id="emailInput" name="email" placeholder="you're a dirty lil email" required>
	<div class="button-container">
		<br>
		<button type="submit">Touch it</button>
	</div>
</form>

<p id="message"></p>

{% endblock %}

{% block scripts %}
<script>

	console.log("JavaScript loaded successfully!");

	document.getElementById("emailForm").addEventListener("submit", async function (event) {
		event.preventDefault();
		console.log("Form submitted");
		const email = document.getElementById("emailInput").value;
		console.log("Email entered:", email);

		try {
			console.log("Sending request to /subscribe");

			const response = await fetch("{{ url_for('subscribe') }}", {
				method: "POST",
				headers: { "Content-Type": "application/json" },
				body: JSON.stringify({ email: email })
			});

			console.log("Response status:", response.status);
			const data = await response.json();
			console.log("Server response:", data);

			document.getElementById("message").textContent = data.message;
		} catch (error) {
			console.error("Error:", error);
			document.getElementById("message").textContent = "Something went wrong. Please try again.";
		}
	});	
</script>
{% endblock %}